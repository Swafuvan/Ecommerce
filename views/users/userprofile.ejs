<%- include('header') %>

    <main class="main">
        <div class="page-header breadcrumb-wrap">
            <div class="container">
                <div class="breadcrumb">
                    <a href="/" rel="nofollow">Home</a>
                    <span></span> Pages
                    <span></span> Account
                </div>
            </div>
        </div>
        <section class="pt-150 pb-150">
            <div class="container">
                <div class="row">
                    <div class="col-lg-10 m-auto">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="dashboard-menu">
                                    <ul class="nav flex-column" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link active" id="dashboard-tab" href="/profile" role="tab"
                                                aria-selected="false"><i
                                                    class="fi-rs-settings-sliders mr-10"></i>Dashboard</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" id="orders-tab" data-bs-toggle="tab" href="#orders"
                                                role="tab" aria-controls="orders" aria-selected="false"><i
                                                    class="fi-rs-shopping-bag mr-10"></i>Orders</a>
                                        </li>

                                        
                                        <li class="nav-item">
                                            <a class="nav-link" id="address-tab" data-bs-toggle="tab" href="#address"
                                                role="tab" aria-controls="address" aria-selected="true"><i
                                                    class="fi-rs-marker mr-10"></i>My Address</a>
                                        </li>


                                        <li class="nav-item">
                                            <a class="nav-link" href="/logout"><i
                                                    class="fi-rs-sign-out mr-10"></i>Logout</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div class="col-md-9">
                                <div class="tab-content dashboard-content">
                                    <div class="tab-pane fade active show" id="dashboard" role="tabpanel"
                                        aria-labelledby="dashboard-tab">
                                        <a href="/wallet" class="btn mb-30" style="width: 120px; margin-left: 560px;">Wallet</a>
                                        <div class="card ">
                                            
                                            <div class="card-header d-flex">
                                                <div style="width: 30%;" class="float-left">
                                                    <img style=" width: 120px;" class="img-fluid rounded"
                                                        src="/images/WhatsApp Image 2023-07-24 at 00.35.40.jpg"
                                                        alt="image">
                                                    <a data-bs-toggle="modal" data-bs-target="#exampleModal12"
                                                        style="margin-left: 10px; border: none; border-radius: 15%; background-color: darkgray; padding: 5px;"
                                                        class="btn">
                                                        <i class="fa-solid fa-user-pen"></i>Edit profile
                                                    </a>
                                                </div>
                                                <div style="width: 70%;" class="float-left ">
                                                    <h5 class="mb-0 ">
                                                        <%= userdata?.username %>
                                                    </h5>
                                                    <br>
                                                    <h5 class="mb-0">
                                                        <%= userdata?.email %>
                                                    </h5>
                                                    <br>
                                                    <h5 class="mb-0 ">
                                                        <%= userdata?.phone %>
                                                    </h5>
                                                    <br>
                                                    <button class="btn " id="changePassword">Change
                                                        Password</button>
                                                </div>
                                            </div>

                                            <div class="card-body">
                                                <p>From your account dashboard. you can easily check &amp; view your <a
                                                        href="#">recent orders</a>, manage your <a href="#">shipping and
                                                        billing addresses</a> and <a href="#">edit your password and
                                                        account details.</a></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="orders" role="tabpanel" aria-labelledby="orders-tab">
                                        <div class="card">
                                            <div class="card-header">
                                                <h5 class="mb-0">Your Orders</h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="table-responsive">
                                                    <table class="table">
                                                        <thead>
                                                            <tr>
                                                                <th>OrderID</th>
                                                                <th>Date</th>
                                                                <th>Status</th>
                                                                <th>Total</th>
                                                                <th>Payment Status</th>
                                                                <th>Actions</th>
                                                                <th>Order Cancel</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>

                                                            <% orderdata.forEach((items)=>{ %>
                                                                <tr>
                                                                    <td>
                                                                        <%= items.orderId %>
                                                                    </td>
                                                                    <td>
                                                                        <%= items.orderDate %>
                                                                    </td>
                                                                    <td>
                                                                        <%= items.status %>
                                                                    </td>
                                                                    <td>
                                                                        <%= items.totalPrice %>
                                                                    </td>
                                                                    <td>
                                                                        <%= items.payment %>
                                                                    </td>
                                                                    <td><a href="/orderPage?orderid=<%= items._id %>"
                                                                            class="btn-small d-block">View</a></td>
                                                                    <% if(items.status ==='Delivered'){ %>
                                                                        <td><a onclick="returnOrder('<%= items._id %>')"
                                                                            id="" class="btn-small d-block">Return</a></td>
                                                                    <% }else if(items.status ==='returned'){ %>
                                                                        <td>
                                                                            <p>Return</p>
                                                                             <% if(items.states === 'Return'){ %>
                                                                                <p>Amount Pendng</p>
                                                                             <% } %>
                                                                        </td>
                                                                    <% }else{ %>
                                                                        <% if(items.status === 'Cancelled'){ %>
                                                                            <td>
                                                                                <p>Cancelled</p>
                                                                            </td>
                                                                        <% }else { %>
                                                                            <td><a onclick="cancelOrder('<%= items._id %>')"
                                                                                id="" class="btn-small d-block">Cancel
                                                                                Order</a></td>
                                                                        <% } %>   
                                                                        
                                                                    <% } %>
                                                                    
                                                                </tr>

                                                                <% }) %>

                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="tab-pane fade" id="address" role="tabpanel"
                                        aria-labelledby="address-tab">
                                        <!-- Button to trigger the modal -->
                                        <% if(addressdata?.userAddress.length<3 ){ %>
                                            <div class="row d-flex justify-content-end mb-4">
                                                <button class="btn " id="openModalButton" data-bs-toggle="modal"
                                                    data-bs-target="#exampleModal">
                                                    Add Address</button>
                                            </div>
                                            <% }else if(!addressdata?.userAddress){ %>
                                                <div class="row d-flex justify-content-end mb-4">
                                                    <button class="btn " id="openModalButton" data-bs-toggle="modal"
                                                        data-bs-target="#exampleModal">
                                                        Add Address</button>
                                                </div>
                                                <% } %>

                                                    <!-- Add address modal -->
                                                    <div class="modal fade" id="exampleModal" tabindex="-1"
                                                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog">
                                                            <div class="modal-content modal-dialog-scrollable">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="addressModalLabel">Add
                                                                        Address</h5>
                                                                    <button type="button" class="btn-close"
                                                                        data-bs-dismiss="modal"
                                                                        aria-label="Close"></button>
                                                                    </button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <!-- Your form content goes here -->
                                                                    <form id="addressForm" action="/addAddress"
                                                                        method="post" onsubmit="return validation()">
                                                                        <!-- Form fields for address details -->
                                                                        <div class="form-group mb-3">
                                                                            <label for="addressType">Address
                                                                                Type</label>
                                                                            <select class="form-control"
                                                                                id="addressType" name="addressType">
                                                                                <option name="home" value="home">Home
                                                                                </option>
                                                                                <option name="work" value="work">Work
                                                                                </option>
                                                                                <option name="temp" value="temp">
                                                                                    Temporary</option>
                                                                            </select>
                                                                            <span id="addressTypeError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="Firstname">Firstname</label>
                                                                            <input name="Firstname" type="text"
                                                                                class="form-control" id="Firstname"
                                                                                placeholder="Firstname">
                                                                            <span id="FirstnameError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="Lastname">Lastname</label>
                                                                            <input name="Lastname" type="text"
                                                                                class="form-control" id="Lastname"
                                                                                placeholder="Lastname">
                                                                            <span id="LastnameError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="houseNo">House No</label>
                                                                            <input name="HouseNo" type="text"
                                                                                class="form-control" id="houseNo"
                                                                                placeholder="House Number">
                                                                            <span id="houseNoError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="street">Street</label>
                                                                            <input name="Street" type="text"
                                                                                class="form-control" id="street"
                                                                                placeholder="Street">
                                                                            <span id="streetError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="landmark">Landmark</label>
                                                                            <input name="Landmark" type="text"
                                                                                class="form-control" id="landmark"
                                                                                placeholder="Landmark">
                                                                            <span id="landError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="pincode">Pincode</label>
                                                                            <input name="Pincode" type="number"
                                                                                class="form-control" id="pincode"
                                                                                placeholder="Pincode">
                                                                            <span id="pincodeError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="city">City</label>
                                                                            <input name="City" type="text"
                                                                                class="form-control" id="city"
                                                                                placeholder="City">
                                                                            <span id="cityError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="district">District</label>
                                                                            <input name="district" type="text"
                                                                                class="form-control" id="district"
                                                                                placeholder="district">
                                                                            <span id="districtError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="state"
                                                                                class="mb-2 d-block">State</label>
                                                                            <input type="text" name="State"
                                                                                class="form-control" id="State"
                                                                                placeholder="State">
                                                                            <span id="stateError"
                                                                                class="text-danger"></span>

                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="country">Country</label>
                                                                            <input name="Country" type="text"
                                                                                class="form-control" id="country"
                                                                                placeholder="Country">
                                                                            <span id="countryError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="phone">phone number</label>
                                                                            <input name="phone" type="text"
                                                                                class="form-control" id="phone"
                                                                                placeholder="phone number">
                                                                            <span id="phoneError"
                                                                                class="text-danger"></span>
                                                                        </div>
                                                                        <div class="form-group mb-3">
                                                                            <label for="email">Email</label>
                                                                            <input name="email" type="text"
                                                                                class="form-control" id="email"
                                                                                placeholder="Email">
                                                                            <span id="emailError"
                                                                                class="text-danger"></span>
                                                                        </div>

                                                                        <div class="modal-footer">
                                                                            <button type="button"
                                                                                class="btn btn-secondary"
                                                                                data-bs-dismiss="modal">Close</button>
                                                                            <button type="submit"
                                                                                class="btn btn-primary">Save
                                                                                changes</button>
                                                                        </div>
                                                                    </form>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <% if(addressdata && addressdata?.userAddress.length>0){ %>
                                                            <% addressdata?.userAddress.forEach((item,index)=>{ %>
                                                                <div class="col-lg-12" id="cardRemove<%= index %>">
                                                                    <div class="card mb-20">
                                                                        <% if(item.addressType==='temp' ){ %>
                                                                            <div class="card-header ">
                                                                                <h5 class="mb-0">Temporary Address</h5>
                                                                            </div>

                                                                            <% }else if(item.addressType==='home' ){ %>
                                                                                <div class="card-header">
                                                                                    <h5 class="mb-0">Home Address</h5>
                                                                                </div>


                                                                                <% }else{ %>
                                                                                    <div class="card-header">
                                                                                        <h5 class="mb-0">Work Address
                                                                                        </h5>
                                                                                    </div>

                                                                                    <% } %>
                                                                                        <div class="card-body">
                                                                                            <address>
                                                                                                <%= item.Firstname %>
                                                                                                    ,<br>
                                                                                                    <%= item.phone %>,
                                                                                                        <%= item.Street
                                                                                                            %><br>
                                                                                                            <%= item.HouseNo
                                                                                                                %>, <%=
                                                                                                                    item.City
                                                                                                                    %>,
                                                                                                                    <%= item.State
                                                                                                                        %>
                                                                                                                        <br>
                                                                                                                        <%= item.pincode
                                                                                                                            %>
                                                                                                                            ,
                                                                                                                            <%= item.district
                                                                                                                                %>
                                                                                                                                <br>

                                                                                            </address>
                                                                                            <p>
                                                                                                <%= item.Country %>
                                                                                            </p>
                                                                                        </div>
                                                                                        <div
                                                                                            class="card-footer d-flex  justify-content-between">
                                                                                            <button class="btn"
                                                                                                data-toggle="modal"
                                                                                                onclick="editAddress()"
                                                                                                data-target="#exampleModal333<%= index %>">Edit</button>
                                                                                            <button class="btn"
                                                                                                type="button"
                                                                                                onclick="addressRemove('<%= index %>','<%= addressdata._id %>')">Remove</button>
                                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <!-- Modal for Editing Address -->



                                                                <div class="modal fade" id="exampleModal333<%= index %>"
                                                                    tabindex="-1" aria-labelledby="exampleModalLabel333"
                                                                    aria-hidden="true">
                                                                    <div class="modal-dialog">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <h5 class="modal-title fs-5"
                                                                                    id="exampleModalLabel333">Edit
                                                                                    Address</h5>
                                                                                <button type="button" class="btn-close"
                                                                                    data-dismiss="modal"
                                                                                    aria-label="Close"></button>

                                                                            </div>


                                                                            <div class="modal-body">
                                                                                <form id="editaddressForm"
                                                                                    action="/editaddress" method="post" onsubmit="return validation2()">
                                                                                    <!-- Form fields for address details -->
                                                                                    <div class="form-group mb-3">
                                                                                        <label for="addressType">Address
                                                                                            Type</label>
                                                                                        <input type="hidden" id="id"
                                                                                            name="id"
                                                                                            value="<%= item._id %>">
                                                                                        <input type="hidden" id="index"
                                                                                            name="index"
                                                                                            value="<%= index %>">
                                                                                        <select class="form-control"
                                                                                            id="editAddressType"
                                                                                            value="<%= item.addressType %>"
                                                                                            name="addressType" required>
                                                                                            <option value="home"
                                                                                                name="home" <% if
                                                                                                (item.addressType==='home'
                                                                                                ) { %>selected<% } %>>
                                                                                                    Home</option>
                                                                                            <option value="work"
                                                                                                name="work" <% if
                                                                                                (item.addressType==='work'
                                                                                                ) { %>selected<% } %>>
                                                                                                    Work</option>
                                                                                            <option value="temp"
                                                                                                name="temp" <% if
                                                                                                (item.addressType==='temp'
                                                                                                ) { %>selected<% } %>>
                                                                                                    Temporary</option>
                                                                                        </select>
                                                                                        <span id="addressTypeError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">

                                                                                        <label
                                                                                            for="Firstname">Firstname</label>
                                                                                        <input type="text"
                                                                                            class="form-control"
                                                                                            id="editFirstname" 
                                                                                            name="Firstname"
                                                                                            value="<%= item.Firstname %>"
                                                                                            placeholder="Firstname">
                                                                                        <span id="editfirstError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">

                                                                                        <label
                                                                                            for="Lastname">Lastname</label>
                                                                                        <input type="text"
                                                                                            class="form-control"
                                                                                            id="editLastname" 
                                                                                            name="Lastname"
                                                                                            value="<%= item.Lastname %>"
                                                                                            placeholder="Lastname">
                                                                                        <span id="editlastError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">

                                                                                        <label for="houseNo">House
                                                                                            No</label>
                                                                                        <input type="text"
                                                                                            class="form-control"
                                                                                            id="editHouseNo" 
                                                                                            name="HouseNo"
                                                                                            value="<%= item.HouseNo %>"
                                                                                            placeholder="House Number">
                                                                                        <span id="edithouseNoError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">
                                                                                        <label
                                                                                            for="street">Street</label>
                                                                                        <input type="text"
                                                                                            class="form-control"
                                                                                            id="editStreet" 
                                                                                            name="Street"
                                                                                            value="<%= item.Street %>"
                                                                                            placeholder="Street">
                                                                                        <span id="editstreetError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">
                                                                                        <label
                                                                                            for="landmark">Landmark</label>
                                                                                        <input type="text"
                                                                                            class="form-control"
                                                                                            id="Landmark"
                                                                                            name="Landmark"
                                                                                            value="<%= item.Landmark%>"
                                                                                            placeholder="Landmark">
                                                                                        <span id="editLandmarkError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">
                                                                                        <label
                                                                                            for="pincode">Pincode</label>
                                                                                        <input type="number"
                                                                                            class="form-control"
                                                                                            id="editpincode"
                                                                                            name="pincode"
                                                                                            value="<%= item.Pincode %>"
                                                                                            placeholder="Pincode">
                                                                                        <span id="editpincodeError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">
                                                                                        <label for="city">City</label>
                                                                                        <input type="text"
                                                                                            class="form-control"
                                                                                            id="editcity" name="city"
                                                                                            
                                                                                            value="<%= item.City %>"
                                                                                            placeholder="City">
                                                                                        <span id="editcityError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">
                                                                                        <label
                                                                                            for="district">District</label>
                                                                                        <input type="text"
                                                                                            class="form-control"
                                                                                            id="editdistrict"
                                                                                            value="<%= item.district %>"
                                                                                            name="district"
                                                                                            placeholder="district">
                                                                                        <span id="editdistrictError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">
                                                                                        <label for="State"
                                                                                            class="mb-2 d-block">State</label>
                                                                                        <input type="text" name="State" id="editState"
                                                                                            value="<%= item.State %>">
                                                                                        <span id="editstateError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">
                                                                                        <label
                                                                                            for="country">Country</label>
                                                                                        <input type="text" 
                                                                                            class="form-control"
                                                                                            id="editcountry"
                                                                                            value="<%= item.Country %>"
                                                                                            name="Country"
                                                                                            placeholder="Country">
                                                                                        <span id="editcountryError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">
                                                                                        <label
                                                                                            for="country">Email</label>
                                                                                        <input type="email" 
                                                                                            class="form-control"
                                                                                            id="editemail"
                                                                                            value="<%= item.email %>"
                                                                                            name="email"
                                                                                            placeholder="Email">
                                                                                        <span id="editemailError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <div class="form-group mb-3">
                                                                                        <label
                                                                                            for="country">phone</label>
                                                                                        <input type="tel" 
                                                                                            class="form-control"
                                                                                            id="editphone"
                                                                                            value="<%= item.phone %>"
                                                                                            name="phone"
                                                                                            placeholder="Phone number">
                                                                                        <span id="editphoneError"
                                                                                            class="text-danger"></span>
                                                                                    </div>
                                                                                    <!-- Other address fields here... -->

                                                                            </div>
                                                                            <div class="modal-footer">
                                                                                <button type="submit"
                                                                                    class="btn btn-primary">Save</button>
                                                                                <button type="button"
                                                                                    class="btn btn-secondary"
                                                                                    data-dismiss="modal">Close</button>
                                                                            </div>
                                                                            </form>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <% }) %>
                                                                    <% }else{ %>
                                                                        <div class="col-lg-12">
                                                                            <h5>Not Address Found</h5>
                                                                        </div>
                                                                        <% } %>
                                                    </div>
                                    </div>








                                    <div class="tab-pane fade" id="account-detail" role="tabpanel"
                                        aria-labelledby="account-detail-tab">
                                        <div class="card">
                                            <div class="card-header">
                                                <h5>Account Details</h5>
                                            </div>
                                            <div class="card-body">
                                                <p>Already have an account? <a href="page-login-register.html">Log in
                                                        instead!</a></p>
                                                <form method="post" name="enq">
                                                    <div class="row">
                                                        <div class="form-group col-md-6">
                                                            <label>First Name <span class="required">*</span></label>
                                                            <input required="" class="form-control square" name="name"
                                                                type="text">
                                                        </div>
                                                        <div class="form-group col-md-6">
                                                            <label>Last Name <span class="required">*</span></label>
                                                            <input required="" class="form-control square" name="phone">
                                                        </div>
                                                        <div class="form-group col-md-12">
                                                            <label>Display Name <span class="required">*</span></label>
                                                            <input required="" class="form-control square" name="dname"
                                                                type="text">
                                                        </div>
                                                        <div class="form-group col-md-12">
                                                            <label>Email Address <span class="required">*</span></label>
                                                            <input required="" class="form-control square" name="email"
                                                                type="email">
                                                        </div>
                                                        <div class="form-group col-md-12">
                                                            <label>Current Password <span
                                                                    class="required">*</span></label>
                                                            <input required="" class="form-control square"
                                                                name="password" type="password">
                                                        </div>
                                                        <div class="form-group col-md-12">
                                                            <label>New Password <span class="required">*</span></label>
                                                            <input required="" class="form-control square"
                                                                name="npassword" type="password">
                                                        </div>
                                                        <div class="form-group col-md-12">
                                                            <label>Confirm Password <span
                                                                    class="required">*</span></label>
                                                            <input required="" class="form-control square"
                                                                name="cpassword" type="password">
                                                        </div>
                                                        <div class="col-md-12">
                                                            <button type="submit" class="btn btn-fill-out submit"
                                                                name="submit" value="Submit">Save</button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>


    <!-- Modal for edit user -->
    <div class="modal fade" id="exampleModal12" tabindex="-1" aria-labelledby="exampleModalLabel12" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel12">Edit Profile</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="/editprofilepage" method="post" onsubmit="return validations()">

                        <label>
                            <span class="fname">Username <span class="required">*</span></span>
                            <input type="text" name="Username" id="Username" value="<%= userdata.username %>"
                                placeholder="Username">
                                <span class="text-danger" id="nameerr"></span>
                        </label>

                        <label>
                            <span> Profile Picture <span class="required">*</span></span>
                            <input type="file" name="usrimage" id="usrimage" value="<%= userdata.phone %>" placeholder="profile Picture">
                            <span class="text-danger" id="proimgerr"></span>
                        </label>

                        <label>
                            <span> Phone <span class="required">*</span></span>
                            <input type="tel" name="phone" id="prophone" value="<%= userdata.phone %>" placeholder="phone">
                            <span class="text-danger" id="prophoneerr"></span>
                        </label>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary">Save changes</button>
                        </div>
                    </form>

                </div>

            </div>
        </div>
    </div>
    </div>

    <%- include('footer') %>

        <script>

            async function cancelOrder(orderid) {

                let res = await Swal.fire({
                    title: 'Order cancellation?',
                    text: "Are you want to want to cancel this Order!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Sure!'
                })
                if (res.isConfirmed) {
                    const productcart = await fetch('/cancelorder', {
                        method: 'POST',
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ orderid })
                    })
                    if (productcart.status === 202) {
                        await Swal.fire(
                            'Cancell !',
                            'Your Order cancelled Succssfully.',
                            'success'
                        )
                    }
                        location.reload()
                    
                }
            }

            async function addressRemove(arrindex, userid) {
                const addressdata = await fetch('/deleteAddress', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ arrindex, userid })
                })
                if (addressdata.status === 200) {
                    document.getElementById('cardRemove' + arrindex).remove()
                }
            }

            async function editAddress() {
                $('#exampleModal333').modal('show')
            }

            function validation() {
                let valid = true
                const emailInput = document.getElementById('email').value
                const firstInput = document.getElementById('Firstname').value
                const lastInput = document.getElementById('Lastname').value
                const houseInput = document.getElementById('houseNo').value
                const streetInput = document.getElementById('street').value
                const landInput = document.getElementById('landmark').value
                const pinInput = document.getElementById('pincode').value
                const cityInput = document.getElementById('city').value
                const distInput = document.getElementById('district').value
                const stateInput = document.getElementById('State').value
                const countryInput = document.getElementById('country').value
                const phoneInput = document.getElementById('phone').value

                const emailMessage = document.getElementById('emailError');
                const firstMessage = document.getElementById('FirstnameError');
                const lstnameMessage = document.getElementById('LastnameError');
                const houseMessage = document.getElementById('houseNoError');
                const streetMessage = document.getElementById('streetError');
                const landMessage = document.getElementById('landError');
                const pinMessage = document.getElementById('pincodeError');
                const cityMessage = document.getElementById('cityError');
                const districtMessage = document.getElementById('districtError');
                const stateMessage = document.getElementById('stateError');
                const countryMessage = document.getElementById('countryError');
                const phoneMessage = document.getElementById('phoneError');

                emailMessage.textContent = '';
                firstMessage.textContent = '';
                lstnameMessage.textContent = '';
                houseMessage.textContent = '';
                streetMessage.textContent = '';
                landMessage.textContent = '';
                pinMessage.textContent = '';
                cityMessage.textContent = '';
                districtMessage.textContent = '';
                stateMessage.textContent = '';
                countryMessage.textContent = '';
                phoneMessage.textContent = '';

                if (!/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(emailInput)) {
                    emailMessage.textContent = ' enter a valid email address.';
                    valid = false
                }

                if (!/^\d{10}$/.test(phoneInput)) {
                    phoneMessage.textContent = 'Enter a valid 10-digit number.';
                    valid = false;
                }

                // Validate the password field
                if (lastInput.length > 10) {
                    lstnameMessage.textContent = 'your Lastname is Too Long.';
                    valid = false
                } else if (lastInput.trim() === '') {
                    lstnameMessage.textContent = 'Enter your Lastname.';
                    valid = false
                }
                if (firstInput.length > 15) {
                    firstMessage.textContent = 'your Firstname is Too Long.';
                    valid = false
                } else if (firstInput.trim() === '') {
                    firstMessage.textContent = 'Enter your Firstname.';
                    valid = false
                }

                if (houseInput.trim() === '') {
                    houseMessage.textContent = 'Enter your house/Building number.';
                    valid = false
                }
                if (streetInput.trim() === '') {
                    streetMessage.textContent = 'Enter the street Address.';
                    valid = false
                }
                if (landInput.trim() === '') {
                    landMessage.textContent = 'Enter the Landmark .';
                    valid = false
                }
                if (pinInput.trim() === '') {
                    pinMessage.textContent = 'Enter the Pincode.';
                    valid = false
                }
                if (cityInput.trim() === '') {
                    cityMessage.textContent = 'Enter your City.';
                    valid = false
                }
                if (distInput.trim() === '') {
                    districtMessage.textContent = 'Enter your District.';
                    valid = false
                }
                if (stateInput.trim() === '') {
                    stateMessage.textContent = 'Enter your City.';
                    valid = false
                }
                if (countryInput.trim() === '') {
                    countryMessage.textContent = 'Enter your City.';
                    valid = false
                }


                document.getElementById('Firstname').addEventListener('input', function () {
                    document.getElementById('FirstnameError').textContent = '';
                });

                document.getElementById('Lastname').addEventListener('input', function () {
                    document.getElementById('LastnameError').textContent = '';
                });
                document.getElementById('email').addEventListener('input', function () {
                    document.getElementById('emailError').textContent = '';
                });
                document.getElementById('houseNo').addEventListener('input', function () {
                    document.getElementById('houseNoError').textContent = '';
                });
                document.getElementById('street').addEventListener('input', function () {
                    document.getElementById('streetError').textContent = '';
                });
                document.getElementById('landmark').addEventListener('input', function () {
                    document.getElementById('landError').textContent = '';
                });
                document.getElementById('pincode').addEventListener('input', function () {
                    document.getElementById('pincodeError').textContent = '';
                });
                document.getElementById('city').addEventListener('input', function () {
                    document.getElementById('cityError').textContent = '';
                });
                document.getElementById('district').addEventListener('input', function () {
                    document.getElementById('districtError').textContent = '';
                });
                document.getElementById('State').addEventListener('input', function () {
                    document.getElementById('stateError').textContent = '';
                });
                document.getElementById('country').addEventListener('input', function () {
                    document.getElementById('countryError').textContent = '';
                });
                document.getElementById('phone').addEventListener('input', function () {
                    document.getElementById('phoneError').textContent = '';
                });

                return valid
            }

            function validation2() {
                let valid = true
                const emailInput = document.getElementById('editemail').value
                const firstInput = document.getElementById('editFirstname').value
                const lastInput = document.getElementById('editLastname').value
                const houseInput = document.getElementById('editHouseNo').value
                const streetInput = document.getElementById('editStreet').value
                const landInput = document.getElementById('Landmark').value
                const pinInput = document.getElementById('editpincode').value
                const cityInput = document.getElementById('editcity').value
                const distInput = document.getElementById('editdistrict').value
                const stateInput = document.getElementById('editState').value
                const countryInput = document.getElementById('editcountry').value
                const phoneInput = document.getElementById('editphone').value

                const emailMessage = document.getElementById('editemailError');
                const firstMessage = document.getElementById('editfirstError');
                const lstnameMessage = document.getElementById('editlastError');
                const houseMessage = document.getElementById('edithouseNoError');
                const streetMessage = document.getElementById('editstreetError');
                const landMessage = document.getElementById('editLandmarkError');
                const pinMessage = document.getElementById('editpincodeError');
                const cityMessage = document.getElementById('editcityError');
                const districtMessage = document.getElementById('editdistrictError');
                const stateMessage = document.getElementById('editstateError');
                const countryMessage = document.getElementById('editcountryError');
                const phoneMessage = document.getElementById('editphoneError');

                emailMessage.textContent = '';
                firstMessage.textContent = '';
                lstnameMessage.textContent = '';
                houseMessage.textContent = '';
                streetMessage.textContent = '';
                landMessage.textContent = '';
                pinMessage.textContent = '';
                cityMessage.textContent = '';
                districtMessage.textContent = '';
                stateMessage.textContent = '';
                countryMessage.textContent = '';
                phoneMessage.textContent = '';

                if (!/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(emailInput)) {
                    emailMessage.textContent = ' enter a valid email address.';
                    valid = false
                }

                if (!/^\d{10}$/.test(phoneInput)) {
                    phoneMessage.textContent = 'Enter a valid 10-digit number.';
                    valid = false;
                }

                // Validate the password field
                if (lastInput.length > 10) {
                    lstnameMessage.textContent = 'your Lastname is Too Long.';
                    valid = false
                } else if (lastInput.trim() === '') {
                    lstnameMessage.textContent = 'Enter your Lastname.';
                    valid = false
                }
                if (firstInput.length > 15) {
                    firstMessage.textContent = 'your Firstname is Too Long.';
                    valid = false
                } else if (firstInput.trim() === '') {
                    firstMessage.textContent = 'Enter your Firstname.';
                    valid = false
                }

                if (houseInput.trim() === '') {
                    houseMessage.textContent = 'Enter your house/Building number.';
                    valid = false
                }
                if (streetInput.trim() === '') {
                    streetMessage.textContent = 'Enter the street Address.';
                    valid = false
                }
                if (landInput.trim() === '') {
                    landMessage.textContent = 'Enter the Landmark .';
                    valid = false
                }
                if (pinInput.trim() === '') {
                    pinMessage.textContent = 'Enter the Pincode.';
                    valid = false
                }
                if (cityInput.trim() === '') {
                    cityMessage.textContent = 'Enter your City.';
                    valid = false
                }
                if (distInput.trim() === '') {
                    districtMessage.textContent = 'Enter your District.';
                    valid = false
                }
                if (stateInput.trim() === '') {
                    stateMessage.textContent = 'Enter your City.';
                    valid = false
                }
                if (countryInput.trim() === '') {
                    countryMessage.textContent = 'Enter your City.';
                    valid = false
                }


                document.getElementById('editFirstname').addEventListener('input', function () {
                    document.getElementById('editfirstError').textContent = '';
                });

                document.getElementById('editLastname').addEventListener('input', function () {
                    document.getElementById('editlastError').textContent = '';
                });
                document.getElementById('email').addEventListener('input', function () {
                    document.getElementById('editemailError').textContent = '';
                });
                document.getElementById('editHouseNo').addEventListener('input', function () {
                    document.getElementById('edithouseNoError').textContent = '';
                });
                document.getElementById('editStreet').addEventListener('input', function () {
                    document.getElementById('editstreetError').textContent = '';
                });
                document.getElementById('Landmark').addEventListener('input', function () {
                    document.getElementById('editLandmarkError').textContent = '';
                });
                document.getElementById('pincode').addEventListener('input', function () {
                    document.getElementById('editpincodeError').textContent = '';
                });
                document.getElementById('city').addEventListener('input', function () {
                    document.getElementById('editcityError').textContent = '';
                });
                document.getElementById('district').addEventListener('input', function () {
                    document.getElementById('editdistrictError').textContent = '';
                });
                document.getElementById('editState').addEventListener('input', function () {
                    document.getElementById('editstateError').textContent = '';
                });
                document.getElementById('country').addEventListener('input', function () {
                    document.getElementById('editcountryError').textContent = '';
                });
                document.getElementById('phone').addEventListener('input', function () {
                    document.getElementById('editphoneError').textContent = '';
                });

                return valid
            }

            function validations(){
                let valid=true
                const nameInput = document.getElementById('Username').value
                const phoneInput = document.getElementById('prophone').value

                const nameErr = document.getElementById('nameerr')
                const phoneErr = document.getElementById('prophoneerr')

                if(!nameInput.trim()){
                    nameErr.innerHTML = "Must Enter a Username"
                    valid =false
                }
                if(!/^\d{10}$/.test(phoneInput)){
                    phoneErr.innerHTML = "Phone number must be number"
                    valid =false
                }

                document.getElementById('Username').addEventListener('input', function () {
                    document.getElementById('nameerr').textContent = '';
                });

                document.getElementById('prophone').addEventListener('input', function () {
                    document.getElementById('prophoneerr').textContent = '';
                });
                return valid

            }

            document.getElementById('changePassword').addEventListener('click', async function () {
                const reponses = await fetch('/verifyEmail', {
                    method: 'POST',
                })
                if (reponses.status === 200) {
                    await Swal.fire(
                        'Success!',
                        'Email Sent Successfully.',
                        'success',
                    )
                }else{
                    await Swal.fire(
                        'Failed!',
                        'Email Sent Failed.',
                        'Warning!',
                    )
                }
            })

            async function returnOrder (orderid){
                let res = await Swal.fire({
                    title: 'Return ?',
                    text: "Are you sure to Retun this Product!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Sure!'
                })
                if (res.isConfirmed) {
                    const returndata = await fetch('/returnorder', {
                        method:'POST',
                        headers:{ "Content-Type": "application/json" },
                        body:JSON.stringify({ orderid })
                    })
                    if (returndata.status === 202) {
                        await Swal.fire(
                            'Returned!',
                            'Your Order Returned Succssfully.',
                            'success'
                        )
                    }else{
                        await Swal.fire(
                            'Failed!',
                            'Your Order Returned Failed.',
                            'Error'
                        )
                    }
                        location.reload()
                    
                }
            }
        </script>